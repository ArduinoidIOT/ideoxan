
/* ---------------------------------------------------------------------------------------------- */
/*                                            REQUIRES                                            */
/* ---------------------------------------------------------------------------------------------- */

/* ---------------------------------------- CSS Optimizer --------------------------------------- */

const csso = require('csso')

/* ------------------------------------------- General ------------------------------------------ */
const path = require('path')
const fs = require('fs')

if (!process.env.OPTIMIZE) process.exit(0)
/* ---------------------------------------------------------------------------------------------- */
/*                                        READ DIRECTORIES                                        */
/* ---------------------------------------------------------------------------------------------- */

process.chdir('static/');
fs.readdir('.', (err, files) => files.map(optimizeFile))

/* ---------------------------------------------------------------------------------------------- */
/*                                             METHODS                                            */
/* ---------------------------------------------------------------------------------------------- */

async function optimizeFile(file) {
    if (file.endsWith(".css")) {
        var optimized = csso.minify(fs.readFileSync(file, 'utf-8')).css
        fs.writeFile(file, optimized, err => {})
    }
}
