
/* ---------------------------------------------------------------------------------------------- */
/*                                            REQUIRES                                            */
/* ---------------------------------------------------------------------------------------------- */

/* ---------------------------------------- CSS Optimizer --------------------------------------- */

const csso = require('csso')

/* ------------------------------------------- General ------------------------------------------ */
const path = require('path')
const fs = require('fs')

if (!process.env.OPTIMIZE) process.exit(0)
/* ---------------------------------------------------------------------------------------------- */
/*                                        READ DIRECTORIES                                        */
/* ---------------------------------------------------------------------------------------------- */

process.chdir('static/');
fs.readdir('.', (err, files) => files.map(optimizeFile))

/* ---------------------------------------------------------------------------------------------- */
/*                                             METHODS                                            */
/* ---------------------------------------------------------------------------------------------- */

async function optimizeFile(file) {
    if (file.endsWith(".css")) {
        fs.readFile(file, 'utf-8', (err, data) => {
            var optimized = csso.minify(data).css
            fs.writeFile(file, optimized, err => {})
        })
        
    }
}
